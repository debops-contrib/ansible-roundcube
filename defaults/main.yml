---
# Default variables
# =================

# .. contents:: Sections
#    :local:
#
# -------------------------------
#   Basic configuration options
# -------------------------------

# .. envvar:: roundcube__domain
#
# List of domains which will be used to access the roundcube instance.
roundcube__domain: [ 'roundcube.{{ ansible_domain }}' ]


# .. envvar:: roundcube__nginx_access_policy
#
# Name of the "nginx access policy" for Roundcube webpage. See ``debops.nginx``
# Ansible role for more details.
roundcube__nginx_access_policy: ''


# .. envvar:: roundcube__php5_packages
#
# List of PHP5 packages required by Roundcube.
roundcube__php5_packages: [ 'php-auth-sasl', 'php5-gd', 'php5-intl', 'php5-json',
                           'php5-mcrypt', 'php-mail-mime', 'php-mail-mimedecode',
                           'php-net-smtp', 'php-net-socket', 'php-pear',
                           'php-net-idna2', 'php-net-ldap3' ]


# ---------------------------------------
#   User, group, database configuration
# ---------------------------------------

# .. envvar:: roundcube__user
#
# Roundcube system user account
roundcube__user: 'roundcube'


# .. envvar:: roundcube__group
#
# Roundcube system user group
roundcube__group: 'roundcube'


# .. envvar:: roundcube__home
#
# Roundcube home directory
roundcube__home: '{{ ansible_local.root.home + "/" + roundcube__user }}'


# .. envvar:: roundcube__database_user
#
# Roundcube database user account
roundcube__database_user: 'roundcube'


# .. envvar:: roundcube__database_password
#
# Roundcube database password
roundcube__database_password: "{{ lookup('password', secret + '/credentials/' + ansible_fqdn + '/roundcube/' + roundcube__database + '/' + roundcube__database_user + '/password length=30') }}"


# .. envvar:: roundcube__database
#
# Database definition to use from the ``roundcube__database_map``
roundcube__database: 'sqlite-default'


# .. envvar:: roundcube__database_map
#
# Database connection definitions
roundcube__database_map:

  sqlite-default:
    dbtype: 'sqlite'
    dbname: 'db/roundcube.db'

  mysql-default:
    dbtype: 'mysql'
    dbname: 'roundcubemail'
    dbuser: '{{ roundcube__database_user }}'
    dbpass: '{{ roundcube__database_password }}'
    dbhost: 'localhost'
    dbtableprefix: ''


# --------------------------------
#   Base application directories
# --------------------------------

# .. envvar:: roundcube__src
#
# Base path for git bare repository with Roundcube source
roundcube__src: '{{ ansible_local.root.src + "/" + roundcube__user }}'


# .. envvar:: roundcube__www
#
# Base web root directory for Roundcube website
roundcube__www: '{{ (ansible_local.nginx.www
                    if (ansible_local|d() and
                        ansible_local.nginx|d())
                    else "/srv/www" ) + "/" + roundcube__user }}'


# .. envvar:: roundcube__webserver_user
#
# Roundcube webserver user (needs read-only access to the website code)
roundcube__webserver_user: '{{ ansible_local.nginx.user
                              if (ansible_local|d() and
                                  ansible_local.nginx|d() and
                                  ansible_local.nginx.user|d())
                              else "www-data" }}'


# -------------------------------
#   Git repository and checkout
# -------------------------------

# .. envvar:: roundcube__git_repo
#
# Roundcube source repository
roundcube__git_repo: 'https://github.com/roundcube/roundcubemail.git'


# .. envvar:: roundcube__git_dest
#
# Roundcube source directory on the host
roundcube__git_dest: '{{ roundcube__src + "/" + roundcube__git_repo.split("://")[1] }}'


# .. envvar:: roundcube__git_tag
#
# Roundcube release tag to deploy
roundcube__git_version: '1.1.7'


# .. envvar:: roundcube__git_checkout
#
# Default path where Roundcube source files will be deployed
roundcube__git_checkout: '{{ roundcube__www + "/sites/" + roundcube__domain[0] + "/public" }}'


# ---------------------------------
#   Roundcube application options
# ---------------------------------

# .. envvar:: roundcube__default_host
#
# Mail host chosen to perform the log-in
roundcube__default_host: 'localhost'


# .. envvar:: roundcube__smtp_server
#
# SMTP server host (for sending mails)
roundcube__smtp_server: ''


# .. envvar:: roundcube__smtp_port
#
# SMTP port
roundcube__smtp_port: '25'


# .. envvar:: roundcube__smtp_user
#
# SMTP username (if required) if you use %u as the username Roundcube will
# use the current username for login
roundcube__smtp_user: ''


# .. envvar:: roundcube__smtp_pass
#
# SMTP password (if required) if you use %p as the password Roundcube will
# use the current user's password for login
roundcube__smtp_pass: ''


# .. envvar:: roundcube__des_key
#
# Encryption key for the users imap password which is stored in the session
# record (and the client cookie if remember password is enabled).
roundcube__des_key: '{{ lookup("password", secret + "/credentials/" + ansible_fqdn + "/roundcube/des_key chars=hexdigits length=24") }}'


# .. envvar:: roundcube__local_config_map
#
# Custom configuration values for the Roundcube config.inc.php
roundcube__local_config_map: {}


# .. envvar:: roundcube__group_local_config_map
#
# Custom configuration values which can be defined on a group level and
# eventually are merged with ``roundcube__local_config_map``
roundcube__group_local_config_map: {}


# .. envvar:: roundcube__host_local_config_map
#
# Custom configuration values which can be defined ona host level and
# eventually are merged with ``roundcube__local_config_map``
roundcube__host_local_config_map: {}


# .. envvar:: roundcube__default_plugins
#
# List of plugins shipped and enabled by default with Roundcube
roundcube__default_plugins: [ 'archive', 'filesystem_attachments', 'jqueryui', 'zipdownload' ]


# .. envvar:: roundcube__plugins
#
# Additional Roundcube plugins to enable. Check the ``plugins/`` folder for
# the plugins shipped by default
roundcube__plugins: []


# -------------------
#   Other variables
# -------------------

# .. envvar:: roundcube__max_file_size
#
# Maximum upload size, in MB
roundcube__max_file_size: '30'


# .. envvar:: roundcube__extra_packages
#
# List of additional Debian packages (e.g. language dictionaries) that should
# be installed with Roundcube
roundcube__extra_packages: []
